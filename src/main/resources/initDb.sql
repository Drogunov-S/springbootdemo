DROP TABLE IF EXISTS person, book;
-- DROP TYPE IF EXISTS ROLE_ENUM;
DROP SEQUENCE IF EXISTS person_id_seq, book_id_seq;
-- CREATE TYPE ROLE_ENUM AS ENUM ('GUEST', 'USER', 'ADMIN');
CREATE TABLE person
(
    id         INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    login      VARCHAR(30)  NOT NULL UNIQUE,
    password   VARCHAR(255) NOT NULL CHECK ( LENGTH(password) > 3 ),
    name       VARCHAR(30)  NOT NULL,
    year_birth INT          NOT NULL,
    CHECK (year_birth > 1850),
    email      VARCHAR(255) UNIQUE,
    address    VARCHAR(255) NOT NULL,
    role       VARCHAR(30) DEFAULT 'GUEST'
);
INSERT INTO
    person(name, login, password, year_birth, email, address, role)
VALUES
    ( 'Иванов Иван Иванович', 'ivan', '1234', 1970, 'wewe@yandex.ru'
    , 'Россия, Краснодар, 123456, ул. Партизан дом 5 кв 1'
    , 'GUEST')
  , ( 'Петров Петр Петрович', 'Petr', 'petr', 1960, 'bestboy@i.ru', 'Россия, Москва, 125476, ул. Видова дом 2'
    , 'ADMIN')
  , ( 'Алексеев Алексей Алексеевич', 'Alex', 'AleX', 1989, 'brow2341@mail.ru'
    , 'USA, California, 230506, Wood street 7', 'GUEST')
  , ( 'Познер Владимир Владимирович', 'Vladim', 'pozdnev', 1944, 'Dr-r@i.com'
    , 'Parish, London, 134215, Elfi street 33', 'GUEST')
  , ( 'Федоров Мирон Янович', 'mironlog', 'password', 1985, 'ol.123@rezolver.yu'
    , 'Россия, Краснодар, 353000, ул. Партизан дом 3 кв 1'
    , 'USER')
  , ( 'JIMMY ', 'jimmy', 'kim.', 2000, 'boyboyboy@boy.vok', 'Россия, Краснодар, 123324, ул. Партизан дом 1 кв 2'
    , 'ADMIN');
CREATE TABLE book
(
    id        INT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    person_id INT                                  REFERENCES person (id) ON DELETE SET NULL,
    title     VARCHAR(100)                         NOT NULL,
    author    VARCHAR(200)                         NOT NULL,
    year      INTEGER                              NOT NULL,
    CHECK (year < 10000),
    CHECK (year > 0),
    taken_at  DATE
);
INSERT INTO
    book(title, author, year)
VALUES
    ('Над пропастью во ржи', 'Джером Сэлинджер', 1951)
  , ('День опричника', 'Владимир Сорокин', 2006)
  , ('Тайные виды на гору Фудзи', 'Владимир Пелевин', 2018)
  , ('Философия Java', 'Брюс Эккель', 2018)
  , ('Психопатология обыденной жизни', 'Фрейд Зигмунд', 1904)
  , ('God told Me To', 'Alvan Grouvel', 2007)
  , ('They Died with Their Boots On', 'Ezekiel Corneille', 1993)
  , ('Feed', 'Westbrook Le Marchand', 2012)
  , ('The Kiss of Her Flesh', 'Evangelina Eger', 1985)
  , ('Mixed Nuts', 'Richmond Dulwich', 2012)
  , ('Flesh and the Devil', 'Felicle Rielly', 2011)
  , ('Without a Paddle', 'Corine O''Docherty', 1996)
  , ('Sweetwater', 'Stevie Probetts', 2005)
  , ('Fantastic Four', 'Sherwynd Smittoune', 1998)
  , ('Symphonie pastorale, La', 'Vittoria Pick', 1992)
  , ('Ugly, The', 'Kathrine Moukes', 2007)
  , ('Havana', 'Dedie Speenden', 1990)
  , ('Miraculum', 'Nickolai Hars', 2012)
  , ('Dream Team, The', 'Emmerich Boscott', 1996)
  , ('Soldier Blue', 'Even Bernot', 2000)
  , ('Man to Man', 'Archer Titcombe', 1996)
  , ('Humboldt County', 'Gerda Bellenger', 1999)
  , ('Bad Company', 'Pace Khomishin', 1999)
  , ('Climb, The', 'Mia Worcs', 2009)
  , ('In the Edges: The ''Grizzly Man'' Session ', 'Lizabeth Possek', 2010)
  , ('Like It Is', 'Ruttger Glover', 2006)
  , ('Grass', 'Cassey Langelaan', 2003)
  , ('Not Another Happy Ending', 'Constantino Pharro', 2008)
  , ('Summer Palace (Yihe yuan)', 'Enid Hopkyns', 2006)
  , ('Eagle Has Landed, The', 'Denver Fitzsimon', 2004)
  , ('Jackass 2.5', 'Glynda Passman', 2005)
  , ('Change of Plans (Le code a changé)', 'Caresa Cutmere', 2008)
  , ('Brother (Brat)', 'Pammi Fairbard', 1997)
  , ('His Regeneration', 'Rikki Prawle', 1989)
  , ('Sinister', 'Teena Wield', 1984)
  , ('Just Looking', 'Augusto Essberger', 2004)
  , ('The Emperor''s Club', 'Annalise Stairs', 2003)
  , ('Transylvania', 'Van Gleeson', 1991)
  , ('Eternal Sunshine of the Spotless Mind', 'Fae Gori', 1999)
  , ('Knock on Wood', 'Micheal Tuftin', 2005)
  , ('All the King''s Men', 'Rockwell Goward', 2004)
  , ('Citadel', 'Vick Paz', 2008)
  , ('Hard Core Logo', 'Legra Dax', 2008)
  , ('Hush... Hush, Sweet Charlotte', 'Olympia Hoofe', 2003)
  , ('Cast a Dark Shadow (Angel)', 'Evelin Lesaunier', 2010)
  , ('My Mother''s Courage (Mutters Courage)', 'Ealasaid Ferandez', 2010)
  , ('Harry Potter and the Order of the Phoenix', 'Eugenie Heinl', 2012)
  , ('Café Metropole', 'Durand Gipson', 1994)
  , ('Dave Attell: Captain Miserable', 'Elbertine Gwatkin', 1998)
  , ('Walking on Sunshine', 'Nehemiah Nand', 1999)
  , ('On the Run', 'Cyrill Tilley', 2008)
  , ('Rage in Harlem, A', 'Angie Chatell', 2003)
  , ('My Mother''s Castle (Château de ma mère, Le)', 'Rad Godby', 1992)
  , ('Portrait Werner Herzog', 'Rivalee Genny', 2012)
  , ('Physical Evidence', 'Ester deKnevet', 2012)
  , ('Pretty/Handsome', 'Bat Flint', 2002)
  , ('Wild Geese, The', 'Yoshiko Manach', 1993)
  , ('Arcana', 'Codie Stonehouse', 2007)
  , ('Rocky V', 'Bail Slatcher', 2007)
  , ('Don Q Son of Zorro', 'Vaughn Grassi', 2008)
  , ('Babylon 5', 'Odo Obern', 2011)
  , ('World''s Fastest Indian, The', 'Jacquelyn Kynsey', 1998)
  , ('Lawyer Man', 'Gradey Comoletti', 1994)
  , ('Train', 'Damara Mullin', 1994)
  , ('Lumihiutalemuodostelma', 'Cornelius Grastye', 2010)
  , ('Dark Tower, The', 'Pincus Redmain', 2007)
  , ('Stopped on Track', 'Norrie Epgrave', 2001)
  , ('Into the Woods', 'Bride Blythe', 1996)
  , ('Jerk Theory, The', 'De Dobrowolny', 1994)
  , ('3 Penny Opera, The (Threepenny Opera, The) (3 Groschen-Oper, Die)', 'Sibley Chadwell', 2012)
  , ('Doggiewoggiez! Poochiewoochiez!', 'Opal Geere', 2009)
  , ('Three Resurrected Drunkards (Kaette kita yopparai)', 'Meredithe McKyrrelly', 2001)
  , ('The Rebel', 'Lizette McGebenay', 2012)
  , ('911 in Plane Site', 'Sande Beauchamp', 2011)
  , ('Crime Wave', 'Fancie Lacey', 1993)
  , ('My Favorite Brunette', 'Hollyanne Parman', 1990)
  , ('Billy Madison', 'Denney Morin', 2006)
  , ('Small Town, The (a.k.a. The Town) (Kasaba)', 'Della Pardy', 2002)
  , ('Animal, The', 'Rhys Kolushev', 1999)
  , ('Witness', 'Cale Chaytor', 2006)
  , ('Banana Joe', 'Tove Sennett', 1997)
  , ('Tempest, The', 'Pamelina Rogans', 1988)
  , ('Gitmo', 'Inez Lecordier', 1998)
  , ('Invisible Stripes', 'Berti Adds', 2008)
  , ('Nightmare on Elm Street 2: Freddy''s Revenge, A', 'Robin Langdridge', 1986)
  , ('My Father and My Son (Babam ve oglum)', 'Genevra Labroue', 2006)
  , ('Bringing Down the House', 'Link Staveley', 1994)
  , ('Bloodsucking Freaks', 'Audra Hamerton', 2011)
  , ('Madeline', 'Zuzana Dooler', 1988)
  , ('Nueba Yol', 'Dahlia Weedon', 2001)
  , ('Night of the Ghouls', 'Pearle Blowfield', 2002)
  , ('Better Tomorrow II, A (Ying hung boon sik II)', 'Manya Andreichik', 1999)
  , ('Mad Dog Time', 'Guss Briat', 1988)
  , ('Five Minutes to Live', 'Tad Le Marquis', 1978)
  , ('Eye, The', 'Everett Swett', 1987)
  , ('Ursul', 'Isabel Reddyhoff', 1999)
  , ('Legend of the Guardians: The Owls of Ga''Hoole', 'Shellie Hintzer', 1997)
  , ('Gayniggers From Outer Space', 'Sharline Hubberstey', 1984)
  , ('Love Bites', 'Georgiana Brewis', 2008)
  , ('New York Ripper, The (Squartatore di New York, Lo)', 'Adorne Brighouse', 2004)
  , ('Harmontown', 'Antonio Brittan', 2002)
  , ('Cottage, The', 'Fidelia Gilffillan', 1992)
  , ('Happy Birthday to Me', 'Nevsa Ivetts', 2000)
  , ('Ace Ventura: Pet Detective', 'Loutitia Goward', 2003)
  , ('Sorceress', 'Leonidas Noe', 2001)
  , ('Getaway, The', 'Eran Mowday', 1992)
  , ('Hitman (Contract Killer) (Sat sau ji wong)', 'Maurice Gingold', 1994)
  , ('Spider Forest (Geomi sup)', 'Broderick Durnin', 1996)
  , ('Tough Guys Don''t Dance', 'Chlo Dike', 1995)
  , ('Way We Were, The', 'Bennie Downham', 1988)
  , ('Stowaway', 'Conney Scolding', 1998)
  , ('Now and Forever', 'Lamond Aldersley', 2005)
  , ('Ten Commandments, The', 'Noll Vasiljevic', 2008)
  , ('Heatstroke', 'Meryl Blasi', 2006)
  , ('Hedgehog, The (Le hérisson)', 'Anstice Varran', 2004)
  , ('Barabbas', 'Enrique Tyer', 2005)
  , ('Criminal Law', 'Clarice Clorley', 1999)
  , ('Venus & Fleur', 'Eugenius Teers', 2009)
  , ('Feast II: Sloppy Seconds', 'Kendre Nugent', 2009)
  , ('House of the Seven Gables, The', 'Wyatt Congdon', 2004)
  , ('Disney Princess Collection: Jasmine''s Enchanted Tales: Jasmine''s Wish', 'Cam Shotbolt', 2007)
  , ('Zulu', 'Falito Drewet', 2004)
  , ('Hoosiers (a.k.a. Best Shot)', 'Niles Churchin', 1988)
  , ('Evening Star, The', 'Faun Jerman', 1987)
  , ('3:10 to Yuma', 'Grantham Eliassen', 2009)
  , ('Map of the Sounds of Tokyo', 'Sidonia Gladdifh', 1995)
  , ('They Died with Their Boots On', 'Nicko Wisdom', 2011)
  , ('Imago mortis', 'Becky Reynard', 1969)
  , ('Parental Guidance', 'Gilburt McIlrath', 1989)
  , ('Miami Vice', 'Nels Holley', 2009)
  , ('Man Who Saves the World, The (Dünyayi Kurtaran Adam)', 'Hewet Poate', 2004)
  , ('Stoning of Soraya M., The', 'Jules Gladeche', 2004)
  , ('MacGyver: Trail to Doomsday', 'Lilly Polack', 1998)
  , ('Cop', 'Ravid Crebott', 1996)
  , ('Best of the Best', 'Alexa Gaskins', 2009)
  , ('Funeral Parade of Roses (Bara no sôretsu)', 'Stacy Trayte', 2005)
  , ('Julian Po', 'Shirl Wessing', 1993)
  , ('Germany Pale Mother', 'Erma Lowin', 2007)
  , ('Psych-Out', 'Pennie Tibbs', 2003)
  , ('Tales from the Script', 'Huntington Snarie', 1999)
  , ('Moon Child', 'Eryn Garioch', 2011)
  , ('Horror of the Zombies', 'Alfy Wilmot', 2006)
  , ('Plato''s Academy', 'Frankie Danilevich', 2011)
  , ('De nieuwe Wildernis', 'Kalinda Goldis', 1993)
  , ('Sapphires, The', 'Hebert Bolus', 1992)
  , ('Housewarming (Travaux, on sait quand ça commence...)', 'Christophorus Braizier', 1995)
  , ('Wife vs. Secretary', 'Claiborn Paur', 2007)
  , ('Serpico', 'Emlynne Golton', 2010)
  , ('Sanjuro (Tsubaki Sanjûrô)', 'Zaneta Moles', 1996)
  , ('Murder à la Mod', 'Artur Driutti', 1994)
  , ('Costa Brava', 'Haleigh Costock', 2000)
  , ('Ice Men', 'Clark Tyrrell', 2012)
  , ('Escape Artist, The', 'Tandi Cattellion', 2005)
  , ('Grandmother', 'Jdavie Roistone', 2006)
  , ('Hilary and Jackie', 'Phillipp Manssuer', 2011)
  , ('Fireworks (Hana-bi)', 'Shaylyn Benko', 1993)
  , ('Ghost Goes West, The', 'Averil Muff', 2008)
  , ('Mooring, The', 'Gradeigh Ashtonhurst', 2008)
  , ('Pahat pojat', 'Haleigh Manders', 1998)
  , ('Michael', 'Ivor Crowcroft', 1991)
  , ('Snarveien (Detour)', 'Rodina Dinneen', 2001)
  , ('Garlic Is As Good As Ten Mothers', 'Jerrylee Trewhela', 1994)
  , ('Shirin', 'Frank McGaugie', 2001)
  , ('Stormbreaker (Alex Rider: Operation Stormbreaker)', 'Salem Yurkiewicz', 2008)
  , ('Mackenna''s Gold', 'Tonye Crebott', 2011)
  , ('Secret Life of Words, The', 'Nancie Springham', 2004)
  , ('Lost for Life', 'Daisie Postle', 2009)
  , ('Just One of the Girls', 'Astrid Sharratt', 1984)
  , ('Bertie and Elizabeth', 'Garvey Rymer', 2006)
  , ('Gentleman''s Game, A', 'Wally Dyche', 2007)
  , ('Mulan', 'Gonzales Pavlasek', 1985)
  , ('Little Night Music, A', 'Harri Bisson', 2005)
  , ('Hangover, The', 'Samuel Behr', 1995)
  , ('Cruel Story of Youth (Seishun zankoku monogatari)', 'Frederigo Babar', 1978)
  , ('Gate II: Trespassers, The', 'Alvis Brassington', 2012)
  , ('Wings of Desire (Himmel über Berlin, Der)', 'Amalia Larciere', 1995)
  , ('Fire on the Mountain', 'Pen Held', 1996)
  , ('Felix the Cat: The Movie', 'Kirsten Merriton', 2007)
  , ('Killer Joe', 'Marven Wrates', 1995)
  , ('Evil Cult, The (Lord of the Wu Tang) (Yi tian tu long ji: Zhi mo jiao jiao zhu)', 'David Dafforne', 1992)
  , ('Trouble with Girls, The', 'Giacopo Breinlein', 2011)
  , ('Dreamland', 'Alexandrina Quodling', 1998)
  , ('Diary of a Chambermaid, The', 'Tamas Michel', 1998)
  , ('Sleeping Beauty', 'Kimmie Rousel', 1986)
  , ('7th Voyage of Sinbad, The', 'Tiebold Desborough', 2009)
  , ('Missing Person, The', 'Ainslee Devonside', 2008)
  , ('Herr Lehmann', 'Heloise Hartwell', 2011)
  , ('Tale of Two Sisters, A (Janghwa, Hongryeon)', 'Lindon Godehard.sf', 2007)
  , ('Oblivion', 'Gregory Merrywether', 2002)
  , ('Mr. Baseball', 'Ethelyn Tilt', 2010)
  , ('Most Wanted Man, A', 'Dermot Fuzzard', 1999)
  , ('Force of Execution', 'Nalani Toffler', 2007)
  , ('CJ7 (Cheung Gong 7 hou)', 'Herby Sefton', 2011)
  , ('Searching for Sugar Man', 'Franny Rostern', 1998)
  , ('In the Name of the Law', 'Nolie Redbourn', 1998)
  , ('Rodan (Sora no daikaijû Radon)', 'Lorene Lidden', 2010)
  , ('Elvis and Anabelle', 'Clerkclaude Robertot', 2002)
  , ('Heart and Souls', 'Maxie Wellbelove', 2004)
  , ('Something Wild', 'Elliott Soeiro', 1991)
  , ('Hoffa', 'Matthus Godwin', 2007)
  , ('Two Family House', 'Pearce Dibdale', 1997)
  , ('Keys of the Kingdom, The', 'Bevon Spyer', 2005)
  , ('Matrix, The', 'Valaree Iacomini', 1996)
  , ('Man of Straw (Untertan, Der)', 'Katusha Freke', 1998)
  , ('Home Sweet Home', 'Pierson Minnette', 2012);
INSERT INTO
    book(person_id, title, author, year)
VALUES
    (1, 'Игра в бисер', 'Герман Гессе', 1943)
  , (2, 'Бытие и время', 'Мартин Хайдеггер', 1927);
